package portalbr.dbobj.view;

/** DataBase Object from table .Jw_consulta_situacao_importacao
  * @version 23/01/2017 09:36:50
  */
public class Jw_consulta_situacao_importacaoMetaData {

  /*** Method for getting table metadada. 
     * { type, name, length, not_null (parameter type), html_type, label, format, validate_type, case_restriction } */
  public static String[][] getMetadata() {
    String[][] metadata = {
                            {"java.lang.String","tipo","40","false","text","tipo","","","","","","",},
                            {"java.lang.Integer","pares","22","false","text","pares","","","","","","",},
                            {"double","valor","22","false","text","valor","","","","","","",}
                          };
    return metadata;
  }

  public static String getSelect() throws Exception {
    String query = "SELECT 'Com importação automática' tipo,       SUM(NVL(i.quantidade_item, 0)) pares       ,SUM((DECODE(p.tipo_pedido, 'EX', 0, (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) -                     (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0) *                     NVL(p.bonificacao_cliente, 0) / 100) -                     (((NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) -                     (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) *                     NVL(p.bonificacao_cliente, 0) / 100) *                     NVL(p.bonificacao_promocao, 0) / 100)) +            ((DECODE(p.tipo_pedido, 'EX', (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) -                       (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0) *                       NVL(p.bonificacao_cliente, 0) / 100) -                       (((NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) -                       (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) *                       NVL(p.bonificacao_cliente, 0) / 100) *                       NVL(p.bonificacao_promocao, 0) / 100), 0)) * 1))) valor   FROM temp_pedidos_afv p       ,temp_itens_afv   i       ,lin              l       ,REF              r       ,rep              u       ,marcas_produtos  m  WHERE p.data_emissao >= TRUNC(SYSDATE - 520)    AND p.pedido_ifv = i.pedido_ifv    AND p.pedido_beira_rio = i.pedido_beira_rio    AND p.tipo_registro = i.tipo_registro    AND NVL(i.codigo_linha, NULL) = l.lin_cdgo    AND NVL(i.codigo_linha, NULL) = r.lin_cdgo    AND NVL(i.codigo_referencia, NULL) = r.ref_cdgo    AND NVL(p.status_pedido, NULL) NOT IN ('C')    AND p.especie_pedido IN ('F', 'N', 'X', 'P', 'M')    AND NVL(p.codigo_cliente, NULL) <> 40000    AND p.codigo_representante = u.rep_cdgo    AND r.codigo_marca = m.codigo_marca    AND NVL(p.amostra_brinde, 'A') <> 'B'    AND NVL(p.ped_devolver_repres, 'N') = 'N'    AND NOT EXISTS (SELECT 1 FROM ped WHERE ped.ped_nmro = p.ped_nmro) UNION all SELECT 'Sem importação automática' tipo, SUM(NVL(i.quantidade_item, 0)) pares       ,SUM((DECODE(p.tipo_pedido, 'EX', 0, (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) -                     (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0) *                     NVL(p.bonificacao_cliente, 0) / 100) -                     (((NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) -                     (NVL(i.quantidade_item, 0) *                     NVL(i.valor_bruto, 0)) *                     NVL(p.bonificacao_cliente, 0) / 100) *                     NVL(p.bonificacao_promocao, 0) / 100)) +            ((DECODE(p.tipo_pedido, 'EX', (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) -                       (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0) *                       NVL(p.bonificacao_cliente, 0) / 100) -                       (((NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) -                       (NVL(i.quantidade_item, 0) *                       NVL(i.valor_bruto, 0)) *                       NVL(p.bonificacao_cliente, 0) / 100) *                       NVL(p.bonificacao_promocao, 0) / 100), 0)) * 1))) valor   FROM temp_pedidos_afv p       ,temp_itens_afv   i       ,lin              l       ,REF              r       ,rep              u       ,marcas_produtos  m  WHERE p.data_emissao >= TRUNC(SYSDATE - 520)    AND p.pedido_ifv = i.pedido_ifv    AND p.pedido_beira_rio = i.pedido_beira_rio    AND p.tipo_registro = i.tipo_registro    AND NVL(i.codigo_linha, NULL) = l.lin_cdgo    AND NVL(i.codigo_linha, NULL) = r.lin_cdgo    AND NVL(i.codigo_referencia, NULL) = r.ref_cdgo    AND NVL(p.status_pedido, NULL) NOT IN ('C')    AND p.especie_pedido IN ('F', 'N', 'X', 'P', 'M')    AND NVL(p.codigo_cliente, NULL) <> 40000    AND p.codigo_representante = u.rep_cdgo    AND r.codigo_marca = m.codigo_marca    AND NVL(p.amostra_brinde, 'A') <> 'B'    AND NVL(p.ped_devolver_repres, 'N') = 'N'";
    return query;
  }

}
